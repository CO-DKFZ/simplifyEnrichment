<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Perform simplifyGO analysis with multiple lists of GO IDs — simplifyGOFromMultipleLists • simplifyEnrichment</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Perform simplifyGO analysis with multiple lists of GO IDs — simplifyGOFromMultipleLists" />
<meta property="og:description" content="Perform simplifyGO analysis with multiple lists of GO IDs" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simplifyEnrichment</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.5.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/simplifyEnrichment.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/interactive.html">A Shiny app to interactively visualize clustering results</a>
    </li>
    <li>
      <a href="../articles/word_cloud_anno.html">Word Cloud Annotation</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/jokergoo/simplifyEnrichment/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Perform simplifyGO analysis with multiple lists of GO IDs</h1>
    
    <div class="hidden name"><code>simplifyGOFromMultipleLists.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Perform simplifyGO analysis with multiple lists of GO IDs</p>
    </div>

    <pre class="usage"><span class='fu'>simplifyGOFromMultipleLists</span><span class='op'>(</span><span class='va'>lt</span>, go_id_column <span class='op'>=</span> <span class='cn'>NULL</span>, padj_column <span class='op'>=</span> <span class='cn'>NULL</span>, padj_cutoff <span class='op'>=</span> <span class='fl'>1e-2</span>,
    filter <span class='op'>=</span> <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/any.html'>any</a></span><span class='op'>(</span><span class='va'>x</span> <span class='op'>&lt;</span> <span class='va'>padj_cutoff</span><span class='op'>)</span>, default <span class='op'>=</span> <span class='fl'>1</span>,
    ont <span class='op'>=</span> <span class='cn'>NULL</span>, db <span class='op'>=</span> <span class='st'>'org.Hs.eg.db'</span>, measure <span class='op'>=</span> <span class='st'>"Rel"</span>,
    heatmap_param <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span><span class='cn'>NULL</span><span class='op'>)</span>,
    method <span class='op'>=</span> <span class='st'>"binary_cut"</span>, control <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/list.html'>list</a></span><span class='op'>(</span>partial <span class='op'>=</span> <span class='cn'>TRUE</span><span class='op'>)</span>,
    min_term <span class='op'>=</span> <span class='cn'>NULL</span>, verbose <span class='op'>=</span> <span class='cn'>TRUE</span>, column_title <span class='op'>=</span> <span class='cn'>NULL</span>, <span class='va'>...</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>lt</th>
      <td><p>A data frame, a list of numeric vectors (e.g. adjusted p-values) where each numeric vector has GO IDs as names, or a list of GO IDs.</p></td>
    </tr>
    <tr>
      <th>go_id_column</th>
      <td><p>Column index of GO ID if <code>lt</code> contains a list of data frames.</p></td>
    </tr>
    <tr>
      <th>padj_column</th>
      <td><p>Column index of adjusted p-values if <code>lt</code> contains a list of data frames.</p></td>
    </tr>
    <tr>
      <th>padj_cutoff</th>
      <td><p>Cut off for adjusted p-values</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>A self-defined function for filtering GO IDs. By default it requires GO IDs should be significant in at least one list.</p></td>
    </tr>
    <tr>
      <th>default</th>
      <td><p>The default value for the adjusted p-values. See Details.</p></td>
    </tr>
    <tr>
      <th>ont</th>
      <td><p>GO ontology. Value should be one of "BP", "CC" or "MF". If it is not specified, the function automatically identifies it by random sampling 10 IDs from <code>go_id</code> (see <code><a href='guess_ont.html'>guess_ont</a></code>).</p></td>
    </tr>
    <tr>
      <th>db</th>
      <td><p>Annotation database. It should be from <a href='https://bioconductor.org/packages/3.10/BiocViews.html#___OrgDb'>https://bioconductor.org/packages/3.10/BiocViews.html#___OrgDb</a></p></td>
    </tr>
    <tr>
      <th>measure</th>
      <td><p>Semantic measure for the GO similarity, pass to <code><a href='https://rdrr.io/pkg/GOSemSim/man/termSim.html'>termSim</a></code>.</p></td>
    </tr>
    <tr>
      <th>heatmap_param</th>
      <td><p>Parameters for controlling the heatmap, see Details.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Pass to <code><a href='simplifyGO.html'>simplifyGO</a></code>.</p></td>
    </tr>
    <tr>
      <th>control</th>
      <td><p>Pass to <code><a href='simplifyGO.html'>simplifyGO</a></code>.</p></td>
    </tr>
    <tr>
      <th>min_term</th>
      <td><p>Pass to <code><a href='simplifyGO.html'>simplifyGO</a></code>.</p></td>
    </tr>
    <tr>
      <th>verbose</th>
      <td><p>Pass to <code><a href='simplifyGO.html'>simplifyGO</a></code>.</p></td>
    </tr>
    <tr>
      <th>column_title</th>
      <td><p>Pass to <code><a href='simplifyGO.html'>simplifyGO</a></code>.</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>Pass to <code><a href='simplifyGO.html'>simplifyGO</a></code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The input data can have three types of formats:</p>
<ul>
<li><p>A list of numeric vectors of adjusted p-values where each vector has the GO IDs as names.</p></li>
<li><p>A data frame. The column of the GO IDs can be specified with <code>go_id_column</code> argument and the column of the adjusted p-values can be specified with <code>padj_column</code> argument. If these columns are not specified, they are automatically identified. The GO ID column is found by checking whether a column contains all GO IDs. The adjusted p-value column is found by comparing the column names of the  data frame to see whether it might be a column for adjusted p-values. These two columns are used to construct a numeric vector with GO IDs as names.</p></li>
<li><p>A list of character vectors of GO IDs. In this case, each character vector is changed to a numeric vector where all values take 1 and the original GO IDs are used as names of the vector.</p></li>
</ul>

<p>Now let's assume there are <code>n</code> GO lists, we first construct a global matrix where columns correspond to the <code>n</code> GO lists and rows correspond
to the "union" of all GO IDs in the lists. The value for the ith GO ID and in the jth list are taken from the corresponding numeric vector
in <code>lt</code>. If the jth vector in <code>lt</code> does not contain the ith GO ID, the value defined by <code>default</code> argument is taken there (e.g. in most cases the numeric
values are adjusted p-values, <code>default</code> is set to 1). Let's call this matrix as <code>M0</code>.</p>
<p>Next step is to filter <code>M0</code> so that we only take a subset of GO IDs of interest. We define a proper function via argument <code>filter</code> to remove
GO IDs that are not important for the analysis. Functions for <code>filter</code> is applied to every row in <code>M0</code> and <code>filter</code> function needs
to return a logical value to decide whether to remove the current GO ID. For example, if the values in <code>lt</code> are adjusted p-values, the <code>filter</code> function
can be set as <code>function(x) any(x &lt; padj_cutoff)</code> so that the GO ID is kept as long as it is signfiicant in at least one list. After the filter, let's call
the filtered matrix <code>M1</code>.</p>
<p>GO IDs in <code>M1</code> (row names of <code>M1</code>) are used for clustering. A heatmap of <code>M1</code> is attached to the left of the GO similarity heatmap so that
the group-specific (or list-specific) patterns can be easily observed and to corresponded to GO functions.</p>
<p>Argument <code>heatmap_param</code> controls several parameters for heatmap <code>M1</code>:</p>
<ul>
<li><p><code>transform</code>: A self-defined function to transform the data for heatmap visualization. The most typical case is to transform adjusted p-values by <code>-log10(x)</code>.</p></li>
<li><p><code>breaks</code>: break values for color interpolation.</p></li>
<li><p><code>col</code>: The corresponding values for <code>breaks</code>.</p></li>
<li><p><code>labels</code>: The corresponding labels.</p></li>
<li><p><code>name</code>: Legend title.</p></li>
</ul>


    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># \donttest{</span>
<span class='co'># perform functional enrichment on the signatures genes from cola anlaysis </span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/jokergoo/cola'>cola</a></span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: cola</span></div><div class='output co'>#&gt; <span class='message'>========================================</span>
#&gt; <span class='message'>cola version 1.9.4</span>
#&gt; <span class='message'>Bioconductor page: http://bioconductor.org/packages/cola/</span>
#&gt; <span class='message'>Github page: https://github.com/jokergoo/cola</span>
#&gt; <span class='message'>Documentation: https://jokergoo.github.io/cola/</span>
#&gt; <span class='message'>Examples: https://jokergoo.github.io/cola_collection/</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>If you use it in published research, please cite:</span>
#&gt; <span class='message'>Gu, Z. cola: an R/Bioconductor package for consensus partitioning </span>
#&gt; <span class='message'>  through a general framework. Nucleic Acids Research 2021.</span>
#&gt; <span class='message'></span>
#&gt; <span class='message'>This message can be suppressed by:</span>
#&gt; <span class='message'>  suppressPackageStartupMessages(library(cola))</span>
#&gt; <span class='message'>========================================</span></div><div class='input'><span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='va'>golub_cola</span><span class='op'>)</span> 
<span class='va'>res</span> <span class='op'>=</span> <span class='va'>golub_cola</span><span class='op'>[</span><span class='st'>"ATC:skmeans"</span><span class='op'>]</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>require</a></span><span class='op'>(</span><span class='va'>hu6800.db</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='message'>Loading required package: hu6800.db</span></div><div class='output co'>#&gt; </div><div class='input'><span class='va'>x</span> <span class='op'>=</span> <span class='va'>hu6800ENTREZID</span>
<span class='va'>mapped_probes</span> <span class='op'>=</span> <span class='fu'>mappedkeys</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span>
<span class='va'>id_mapping</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/unlist.html'>unlist</a></span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/list.html'>as.list</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>[</span><span class='va'>mapped_probes</span><span class='op'>]</span><span class='op'>)</span><span class='op'>)</span>
<span class='va'>lt</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/pkg/cola/man/functional_enrichment-dispatch.html'>functional_enrichment</a></span><span class='op'>(</span><span class='va'>res</span>, k <span class='op'>=</span> <span class='fl'>3</span>, id_mapping <span class='op'>=</span> <span class='va'>id_mapping</span><span class='op'>)</span> <span class='co'># you can check the value of `lt`</span>
</div><div class='output co'>#&gt; - 2050/4116 significant genes are taken from 3-group comparisons
#&gt; - on k-means group 1/3, 827 genes
#&gt;   - 651/827 (78.7%) genes left after id mapping
#&gt;   - gene set enrichment, GO:BP
#&gt; - on k-means group 2/3, 359 genes
#&gt;   - 317/359 (88.3%) genes left after id mapping
#&gt;   - gene set enrichment, GO:BP
#&gt; - on k-means group 3/3, 864 genes
#&gt;   - 786/864 (91%) genes left after id mapping
#&gt;   - gene set enrichment, GO:BP</div><div class='input'>
<span class='co'># a list of data frames</span>
<span class='fu'>simplifyGOFromMultipleLists</span><span class='op'>(</span><span class='va'>lt</span>, padj_cutoff <span class='op'>=</span> <span class='fl'>0.001</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Use column 'ID' as `go_id_column`.
#&gt; Use column 'p.adjust' as `padj_column`.</div><div class='output co'>#&gt; <span class='message'>Loading required namespace: gridtext</span></div><div class='output co'>#&gt; 927/6316 GO IDs left for clustering.</div><div class='output co'>#&gt; <span class='message'>You haven't provided value for `ont`, guess it as `BP`.</span></div><div class='output co'>#&gt; Cluster 927 terms by 'binary_cut'... 29 clusters, used 1.871094 secs.
#&gt; Perform keywords enrichment for 8 GO lists...</div><div class='img'><img src='simplifyGOFromMultipleLists-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># a list of numeric values</span>
<span class='va'>lt2</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>lt</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='fu'><a href='https://rdrr.io/r/base/structure.html'>structure</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>$</span><span class='va'>p.adjust</span>, names <span class='op'>=</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>simplifyGOFromMultipleLists</span><span class='op'>(</span><span class='va'>lt2</span>, padj_cutoff <span class='op'>=</span> <span class='fl'>0.001</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 927/6316 GO IDs left for clustering.</div><div class='output co'>#&gt; <span class='message'>You haven't provided value for `ont`, guess it as `BP`.</span></div><div class='output co'>#&gt; Cluster 927 terms by 'binary_cut'... 29 clusters, used 2.616816 secs.
#&gt; Perform keywords enrichment for 8 GO lists...</div><div class='img'><img src='simplifyGOFromMultipleLists-2.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='co'># a list of GO IDS</span>
<span class='va'>lt3</span> <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/lapply.html'>lapply</a></span><span class='op'>(</span><span class='va'>lt</span>, <span class='kw'>function</span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='va'>x</span><span class='op'>$</span><span class='va'>ID</span><span class='op'>[</span><span class='va'>x</span><span class='op'>$</span><span class='va'>p.adjust</span> <span class='op'>&lt;</span> <span class='fl'>0.001</span><span class='op'>]</span><span class='op'>)</span>
<span class='fu'>simplifyGOFromMultipleLists</span><span class='op'>(</span><span class='va'>lt3</span><span class='op'>)</span>
</div><div class='output co'>#&gt; 927/927 GO IDs left for clustering.</div><div class='output co'>#&gt; <span class='message'>You haven't provided value for `ont`, guess it as `BP`.</span></div><div class='output co'>#&gt; Cluster 927 terms by 'binary_cut'... 29 clusters, used 1.87644 secs.
#&gt; Perform keywords enrichment for 8 GO lists...</div><div class='img'><img src='simplifyGOFromMultipleLists-3.png' alt='' width='700' height='433' /></div><div class='input'><span class='co'># }</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


