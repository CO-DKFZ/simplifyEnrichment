<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Simplify Functional Enrichment Results • simplifyEnrichment</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Simplify Functional Enrichment Results">
<meta property="og:description" content="simplifyEnrichment">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">simplifyEnrichment</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../articles/simplifyEnrichment.html">Get started</a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/jokergoo/simplifyEnrichment/">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="simplifyEnrichment_files/header-attrs-2.3/header-attrs.js"></script><script src="simplifyEnrichment_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Simplify Functional Enrichment Results</h1>
                        <h4 class="author">Zuguang Gu (<a href="mailto:z.gu@dkfz.de" class="email">z.gu@dkfz.de</a>)</h4>
            
            <h4 class="date">2020-10-05</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/jokergoo/simplifyEnrichment/blob/master/vignettes/simplifyEnrichment.Rmd"><code>vignettes/simplifyEnrichment.Rmd</code></a></small>
      <div class="hidden name"><code>simplifyEnrichment.Rmd</code></div>

    </div>

    
    
<p>The <strong>simplifyEnrichment</strong> package clusters functional terms into groups by clustering the similarity matrix of the terms with a new proposed method “binary cut” which recursively applies partition around medoids (PAM) with two groups on the similarity matrix and in each iteration step, a score is assigned to decide whether the group of gene sets that corresponds to the current sub-matrix should be split or not. For more details of the method, please refer to the manuscript.</p>
<div id="simplify-go-enrichment-results" class="section level2">
<h2 class="hasAnchor">
<a href="#simplify-go-enrichment-results" class="anchor"></a>Simplify GO enrichment results</h2>
<p>The major use case for <strong>simplifyEnrichment</strong> is for simplying the GO enrichment results by clustering the corresponding semantic similarity matrix of the significant GO terms. To demonstrate the usage, we first generate a list of random GO IDs from the Biological Process (BP) ontology category:</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">simplifyEnrichment</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">888</span>)
<span class="no">go_id</span> <span class="kw">=</span> <span class="fu"><a href="../reference/random_GO.html">random_GO</a></span>(<span class="fl">500</span>)</pre></body></html></div>
<p><strong>simplifyEnrichment</strong> starts with the GO similarity matrix. Users can use their own similarity matrices or use the <code><a href="../reference/GO_similarity.html">GO_similarity()</a></code> function to calculate the semantic similarity matrix. The <code><a href="../reference/GO_similarity.html">GO_similarity()</a></code> function is simply a wrapper on <code><a href="https://rdrr.io/pkg/GOSemSim/man/termSim.html">GOSemSim::termSim()</a></code>. The function accepts a vector of GO IDs. Note the GO terms should only belong to one same ontology (<em>i.e.</em>, <code>BP</code>, <code>CC</code> or <code>MF</code>).</p>
<div class="sourceCode" id="cb2"><html><body><pre class="r"><span class="no">mat</span> <span class="kw">=</span> <span class="fu"><a href="../reference/GO_similarity.html">GO_similarity</a></span>(<span class="no">go_id</span>)</pre></body></html></div>
<p>By default, <code><a href="../reference/GO_similarity.html">GO_similarity()</a></code> uses <code>Rel</code> method in <code><a href="https://rdrr.io/pkg/GOSemSim/man/termSim.html">GOSemSim::termSim()</a></code>. Other methods to calculate GO similarities can be set by <code>measure</code> argument, <em>e.g.</em>:</p>
<div class="sourceCode" id="cb3"><html><body><pre class="r"><span class="fu"><a href="../reference/GO_similarity.html">GO_similarity</a></span>(<span class="no">go_id</span>, <span class="kw">measure</span> <span class="kw">=</span> <span class="st">"Wang"</span>)</pre></body></html></div>
<p>With the similarity matrix <code>mat</code>, users can directly apply <code><a href="../reference/simplifyGO.html">simplifyGO()</a></code> function to perform the clustering as well as visualizing the results.</p>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="no">df</span> <span class="kw">=</span> <span class="fu"><a href="../reference/simplifyGO.html">simplifyGO</a></span>(<span class="no">mat</span>)</pre></body></html></div>
<pre><code>## Cluster 500 terms by 'binary_cut'... 43 clusters, used 1.89732 secs.</code></pre>
<p><img src="simplifyEnrichment_files/figure-html/unnamed-chunk-6-1.png" width="806.4" style="display: block; margin: auto;"></p>
<p>On the right side of the heatmap there are the word cloud annotations which summarize the functions with keywords in every GO cluster. Note there is no word cloud for the cluster that is merged from small clusters (size &lt; 5).</p>
<p>The returned variable <code>df</code> is a data frame with GO IDs, GO terms and the cluster labels:</p>
<div class="sourceCode" id="cb6"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(<span class="no">df</span>)</pre></body></html></div>
<pre><code>##           id                                           term cluster
## 1 GO:0003283                      atrial septum development       1
## 2 GO:0022018 lateral ganglionic eminence cell proliferation       1
## 3 GO:0030032                         lamellipodium assembly       2
## 4 GO:0061508                            CDP phosphorylation       3
## 5 GO:1901222          regulation of NIK/NF-kappaB signaling       4
## 6 GO:0060164 regulation of timing of neuron differentiation       1</code></pre>
<p>The size of GO clusters can be retrieved by:</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/sort.html">sort</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/table.html">table</a></span>(<span class="no">df</span>$<span class="no">cluster</span>))</pre></body></html></div>
<pre><code>## 
##   5   7   8  10  12  13  17  18  21  22  24  25  26  27  28  29  30  31  32  33  34  35  36  37  38 
##   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1   1 
##  39  40  41  42  43  20  23   9  16  19  15  14  11   2   6   4   1   3 
##   1   1   1   1   1   2   2   3   5   5   6  10  12  37  45  97 114 132</code></pre>
<p>Or split the data frame by the cluster labels:</p>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/split.html">split</a></span>(<span class="no">df</span>, <span class="no">df</span>$<span class="no">cluster</span>)</pre></body></html></div>
<p><code>plot</code> argument can be set to <code>FALSE</code> in <code><a href="../reference/simplifyGO.html">simplifyGO()</a></code>, so that no plot is generated and only the data frame is returned.</p>
<p>If the aim is only to cluster GO terms, <code><a href="../reference/binary_cut.html">binary_cut()</a></code> or <code><a href="../reference/cluster_terms.html">cluster_terms()</a></code> functions can be directly applied:</p>
<div class="sourceCode" id="cb11"><html><body><pre class="r"><span class="fu"><a href="../reference/binary_cut.html">binary_cut</a></span>(<span class="no">mat</span>)</pre></body></html></div>
<pre><code>##   [1]  1  1  2  3  4  1  2  3  1  3  5  6  1  3  1  3  6  7  3  3  4  8  4  4  1  1  3  6  3  1  4
##  [32]  3  3  2  3  4  3  4  4  2  2  4  6  6  9  2  6  2  2  3  3  4  2  2  4  6  3  3  4  3  4  3
##  [63]  3  3 10  3  1 11  3  1  6  4  6  3 12  1 13  4 14  2  4 11  6  1  3  4  1  4  4  4 15  3  6
##  [94]  3  3  3  4  3 14  6  3  4 16  6  1  2  2  2 11  4  3  3  3 17  1  4  1  3  6  3  1  3  1  3
## [125]  4  3 16  4  6  4  3  9  3  3  3  3  1  2  3  4  3  1  3  3  3 18  1  2  3  1  3 19  1  3  4
## [156]  1  1  1  1  4  3 20 15  2  3  1  1  1  1  1 21  4  1  4  6  4  4  3  1  4  1  4 11 11 11  1
## [187]  4 11  1  3  6  2  3  1 22  1  3  6  1 14  1  3  4  4  4  2  4  6  3  3  1  3  1  6  3  4  4
## [218] 11  4  1  1 23  1 24  6  4  3  2  1  1  3  1  1  6  1  1  1  4  6  3  4  3  4 16  3  1  1  4
## [249] 25  4  4  4  1  1 26  4  4  4  6  4  1  3  3  3  2 19  4  3  4 27  4  4  2  6  3  3 11  3  6
## [280]  2 16  3  3  2  1  1  6  6  6  3  3  3  1  3  4  3  1  3  1 14 15 28  2 20  1  3  1  1  1  4
## [311]  1  3  3  4  1 19 29  4  4  4  1  4  6  4 30  3  3  6  1  1  3  1  4  2  1  3  3  3  3 19  6
## [342] 14  3  1  1 11  1  1  4 14  6 11  3  3  4  3  3  2  1 14  1  1  4  1  2 31  1  1  4  1  3  4
## [373]  3  1  3 32  1  1  3  1  3  6  3  3  3  1 19  6  3 11  3  1  3  3 33  2  1  4  4  1  6  1  4
## [404]  2 15  6  4  2  3  4  4  4 14  3  3  4  4  1  1  3  6  2  3  2  1  4 34  1  3  1  1 23  3  6
## [435]  4  9  1  1  6  4  1 35 36 37 38  1  1  1  4  2  1 14 15  4  3 14  3  3  6  2  1 15 16  3  4
## [466]  3  3  4  3  3  4  1 39  6  4  3  3  4  3  4  6  2  2  3 40  4  6  4 41  3  1  3  1  3  1  6
## [497] 42 43  4  1</code></pre>
<p>or</p>
<div class="sourceCode" id="cb13"><html><body><pre class="r"><span class="fu"><a href="../reference/cluster_terms.html">cluster_terms</a></span>(<span class="no">mat</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"binary_cut"</span>)</pre></body></html></div>
<p><code><a href="../reference/binary_cut.html">binary_cut()</a></code> and <code><a href="../reference/cluster_terms.html">cluster_terms()</a></code> basically generate the same clusterings, but the labels of clusters might differ.</p>
</div>
<div id="simplify-general-functional-enrichment-results" class="section level2">
<h2 class="hasAnchor">
<a href="#simplify-general-functional-enrichment-results" class="anchor"></a>Simplify general functional enrichment results</h2>
<p>Semantic measurements can be used for the similarity of GO terms. However, there are still a lot of ontologies (e.g. MsigDB gene sets) that are only represented as a list of genes where the similarity between gene sets are mainly measured by gene overlap. <strong>simplifyEnrichment</strong> provides the <code><a href="../reference/term_similarity.html">term_similarity()</a></code> and other related functions (<code><a href="../reference/term_similarity_from_enrichResult.html">term_similarity_from_enrichResult()</a></code>, <code><a href="../reference/term_similarity_from_KEGG.html">term_similarity_from_KEGG()</a></code>, <code><a href="../reference/term_similarity_from_Reactome.html">term_similarity_from_Reactome()</a></code>, <code><a href="../reference/term_similarity_from_MSigDB.html">term_similarity_from_MSigDB()</a></code> and <code><a href="../reference/term_similarity_from_gmt.html">term_similarity_from_gmt()</a></code>) which calculate the similarity of terms by the gene overlapping, with methods of <a href="https://en.wikipedia.org/wiki/Jaccard_index">Jaccard coefficient</a>, <a href="https://en.wikipedia.org/wiki/S%C3%B8rensen%E2%80%93Dice_coefficient">Dice coefficient</a>, <a href="https://en.wikipedia.org/wiki/Overlap_coefficient">overlap coefficient</a> and <a href="https://en.wikipedia.org/wiki/Cohen%27s_kappa">kappa coefficient</a>.</p>
<p>The similarity can be calculated by providing:</p>
<ol style="list-style-type: decimal">
<li>A list of gene sets where each gene set contains a vector of genes.</li>
<li>A <code>enrichResult</code> object which is normally from the ‘clusterProfiler’, ‘DOSE’, ‘meshes’ or ‘ReactomePA’ package.</li>
<li>A list of KEGG/Reactome/MsigDB IDs. The gene set names can also be provided for MsigDB ontologies.</li>
<li>A gmt file and the corresponding gene set IDs.</li>
</ol>
<p>Once you have the similarity matrix, you can send it to <code><a href="../reference/simplifyEnrichment.html">simplifyEnrichment()</a></code> function. But note, as we benchmarked in the manuscript, the clustering on the gene overlap similarity performs much worse than on the semantic similarity.</p>
</div>
<div id="comparing-clustering-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#comparing-clustering-methods" class="anchor"></a>Comparing clustering methods</h2>
<p>In the <strong>simplifyEnrichment</strong> package, there are also functions that compare clustering results from different methods. Here we still use previously generated variable <code>mat</code> which is the similarity matrix from the 500 random GO terms. Simply running <code><a href="../reference/compare_clustering_methods.html">compare_clustering_methods()</a></code> function performs all supported methods (in <code><a href="../reference/all_clustering_methods.html">all_clustering_methods()</a></code>) excluding <code>mclust</code>, because <code>mclust</code> usually takes very long time to run. The function generates a figure with three panels:</p>
<ol style="list-style-type: decimal">
<li>A heatmap of the similarity matrix with different clusterings as row annotations.</li>
<li>A heatmap of the pair-wise concordance of the clustering from every two methods.</li>
<li>Barplots of the difference scores for each method, the number of clusters (total clusters and the clusters with size &gt;= 5) and the mean similarity of the terms that are in the same clusters (block mean).</li>
</ol>
<p>In the barplots, the three metrics are defined as follows:</p>
<ol style="list-style-type: decimal">
<li>
<strong>Different score</strong>: This is the difference between the similarity values for the terms that belong to the same clusters and different clusters. For a similarity matrix <span class="math inline">\(M\)</span>, for term <span class="math inline">\(i\)</span> and term <span class="math inline">\(j\)</span> where <span class="math inline">\(i \ne j\)</span>, the similarity value <span class="math inline">\(x_{i,j}\)</span> is saved to the vector <span class="math inline">\(\mathbf{x_1}\)</span> only when term <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are in a same cluster. <span class="math inline">\(x_{i,j}\)</span> is saved to the vector <span class="math inline">\(\mathbf{x_2}\)</span> when term <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are not in the same cluster. The difference score measures the distribution difference between <span class="math inline">\(\mathbf{x_1}\)</span> and <span class="math inline">\(\mathbf{x_2}\)</span>, calculated as the Kolmogorov-Smirnov statistic between the two distributions.</li>
<li>
<strong>Number of clusters</strong>: For each clustering, there are two numbers: the number of total clusters and the number of clusters with size &gt;= 5 (only the big clusters).</li>
<li>
<strong>Block mean</strong>: The mean similarity values of the blocks in the similarity heatmap. Similar denotation as difference score, for term <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> where <span class="math inline">\(i\)</span> can be the same as <span class="math inline">\(j\)</span> (values on the diagonal are also used), the similarity value <span class="math inline">\(x_{i,j}\)</span> is saved to the vector <span class="math inline">\(\mathbf{x_3}\)</span> only when term <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span> are in a same cluster. The block mean is the mean value over <span class="math inline">\(\mathbf{x_3}\)</span>.</li>
</ol>
<div class="sourceCode" id="cb14"><html><body><pre class="r"><span class="fu"><a href="../reference/compare_clustering_methods.html">compare_clustering_methods</a></span>(<span class="no">mat</span>)</pre></body></html></div>
<pre><code>## Cluster 500 terms by 'binary_cut'... 43 clusters, used 1.952588 secs.
## Cluster 500 terms by 'kmeans'... 20 clusters, used 5.237811 secs.
## Cluster 500 terms by 'dynamicTreeCut'... 58 clusters, used 0.2608001 secs.
## Cluster 500 terms by 'apcluster'... 39 clusters, used 1.637909 secs.
## Cluster 500 terms by 'hdbscan'... 13 clusters, used 0.3365221 secs.
## Cluster 500 terms by 'fast_greedy'... 29 clusters, used 0.264257 secs.
## Cluster 500 terms by 'leading_eigen'... 30 clusters, used 0.4339571 secs.
## Cluster 500 terms by 'louvain'... 29 clusters, used 0.1160738 secs.
## Cluster 500 terms by 'walktrap'... 26 clusters, used 0.4024129 secs.
## Cluster 500 terms by 'MCL'... 28 clusters, used 3.373675 secs.</code></pre>
<p><img src="simplifyEnrichment_files/figure-html/unnamed-chunk-12-1.png" width="960" style="display: block; margin: auto;"></p>
<p>If <code>plot_type</code> argument is set to <code>heatmap</code>. There are heatmaps for the similarity matrix under different clusterings methods. The last panel is a table with the number of clusters.</p>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="../reference/compare_clustering_methods.html">compare_clustering_methods</a></span>(<span class="no">mat</span>, <span class="kw">plot_type</span> <span class="kw">=</span> <span class="st">"heatmap"</span>)</pre></body></html></div>
<pre><code>## Cluster 500 terms by 'binary_cut'... 43 clusters, used 1.456669 secs.
## Cluster 500 terms by 'kmeans'... 16 clusters, used 5.79978 secs.
## Cluster 500 terms by 'dynamicTreeCut'... 58 clusters, used 0.241194 secs.
## Cluster 500 terms by 'apcluster'... 39 clusters, used 1.357504 secs.
## Cluster 500 terms by 'hdbscan'... 13 clusters, used 0.2990639 secs.
## Cluster 500 terms by 'fast_greedy'... 29 clusters, used 0.1889601 secs.
## Cluster 500 terms by 'leading_eigen'... 30 clusters, used 0.435873 secs.
## Cluster 500 terms by 'louvain'... 29 clusters, used 0.136852 secs.
## Cluster 500 terms by 'walktrap'... 26 clusters, used 0.482012 secs.
## Cluster 500 terms by 'MCL'... 28 clusters, used 3.399195 secs.</code></pre>
<p><img src="simplifyEnrichment_files/figure-html/unnamed-chunk-13-1.png" width="1728" style="display: block; margin: auto;"></p>
<p>Please note, the clustering methods might have randomness, which means, different runs of <code><a href="../reference/compare_clustering_methods.html">compare_clustering_methods()</a></code> may generate different clusterings (slightly different). Thus, if users want to compare the plots between <code><a href="../reference/compare_clustering_methods.html">compare_clustering_methods(mat)</a></code> and <code><a href="../reference/compare_clustering_methods.html">compare_clustering_methods(mat, plot_type = "heatmap")</a></code>, they should set the same random seed before executing the function.</p>
<div class="sourceCode" id="cb18"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
<span class="fu"><a href="../reference/compare_clustering_methods.html">compare_clustering_methods</a></span>(<span class="no">mat</span>)
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">123</span>)
<span class="fu"><a href="../reference/compare_clustering_methods.html">compare_clustering_methods</a></span>(<span class="no">mat</span>, <span class="kw">plot_type</span> <span class="kw">=</span> <span class="st">"heatmap"</span>)</pre></body></html></div>
<p><code><a href="../reference/compare_clustering_methods.html">compare_clustering_methods()</a></code> is simply a wrapper on <code><a href="../reference/cmp_make_clusters.html">cmp_make_clusters()</a></code> and <code><a href="../reference/cmp_make_plot.html">cmp_make_plot()</a></code> functions where the former function performs clustering with different methods and the latter visualizes the results. To compare different plots, users can also use the following code without specifying the random seed.</p>
<div class="sourceCode" id="cb19"><html><body><pre class="r"><span class="no">clt</span> <span class="kw">=</span> <span class="fu"><a href="../reference/cmp_make_clusters.html">cmp_make_clusters</a></span>(<span class="no">mat</span>) <span class="co"># just a list of cluster labels</span>
<span class="fu"><a href="../reference/cmp_make_plot.html">cmp_make_plot</a></span>(<span class="no">mat</span>, <span class="no">clt</span>)
<span class="fu"><a href="../reference/cmp_make_plot.html">cmp_make_plot</a></span>(<span class="no">mat</span>, <span class="no">clt</span>, <span class="kw">plot_type</span> <span class="kw">=</span> <span class="st">"heatmap"</span>)</pre></body></html></div>
<div id="register-new-clustering-methods" class="section level3">
<h3 class="hasAnchor">
<a href="#register-new-clustering-methods" class="anchor"></a>Register new clustering methods</h3>
<p>New clustering methods can be added by <code><a href="../reference/register_clustering_methods.html">register_clustering_methods()</a></code>, removed by <code><a href="../reference/remove_clustering_methods.html">remove_clustering_methods()</a></code> and reset to the default methods by <code><a href="../reference/reset_clustering_methods.html">reset_clustering_methods()</a></code>. All the supported methods can be retrieved by <code><a href="../reference/all_clustering_methods.html">all_clustering_methods()</a></code>. <code><a href="../reference/compare_clustering_methods.html">compare_clustering_methods()</a></code> runs all the clustering methods in <code><a href="../reference/all_clustering_methods.html">all_clustering_methods()</a></code>.</p>
<p>The new clustering methods should be as user-defined functions and sent to <code><a href="../reference/register_clustering_methods.html">register_clustering_methods()</a></code> as named arguments, e.g.:</p>
<div class="sourceCode" id="cb20"><html><body><pre class="r"><span class="fu"><a href="../reference/register_clustering_methods.html">register_clustering_methods</a></span>(
    <span class="kw">method1</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">mat</span>, <span class="no">...</span>) <span class="no">...</span>,
    <span class="kw">method2</span> <span class="kw">=</span> <span class="kw">function</span>(<span class="no">mat</span>, <span class="no">...</span>) <span class="no">...</span>,
    <span class="no">...</span>
)</pre></body></html></div>
<p>The functions should accept at least one argument which is the input matrix (<code>mat</code> in above example). The second optional argument should always be <code>...</code> so that parameters for the clustering function can be passed by <code>control</code> argument from <code><a href="../reference/cluster_terms.html">cluster_terms()</a></code> or <code><a href="../reference/simplifyGO.html">simplifyGO()</a></code>. If users forget to add <code>...</code>, it is added internally.</p>
<p>Please note, the user-defined function should automatically identify the optimized number of clusters. The function should return a vector of cluster labels. Internally it is converted to numeric labels.</p>
</div>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>There are following examples which we did for the benchmarking in the manuscript:</p>
<ul>
<li>
<a href="https://simplifyenrichment.github.io/examples/">Examples of simplifyEnrichment</a>.</li>
<li>
<a href="https://simplifyenrichment.github.io/compare_similarity/">Compare different similarity measurements for functional terms</a>.</li>
<li>
<a href="https://simplifyenrichment.github.io/test_partition_methods/">Compare different partitioning methods in binary cut clustering</a>.</li>
</ul>
</div>
<div id="session-info" class="section level2">
<h2 class="hasAnchor">
<a href="#session-info" class="anchor"></a>Session Info</h2>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/utils/sessionInfo.html">sessionInfo</a></span>()</pre></body></html></div>
<pre><code>## R version 4.0.2 (2020-06-22)
## Platform: x86_64-apple-darwin17.0 (64-bit)
## Running under: macOS Catalina 10.15.5
## 
## Matrix products: default
## BLAS:   /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRblas.dylib
## LAPACK: /Library/Frameworks/R.framework/Versions/4.0/Resources/lib/libRlapack.dylib
## 
## locale:
## [1] en_GB.UTF-8/en_GB.UTF-8/en_GB.UTF-8/C/en_GB.UTF-8/en_GB.UTF-8
## 
## attached base packages:
## [1] grid      parallel  stats     graphics  grDevices utils     datasets  methods   base     
## 
## other attached packages:
## [1] simplifyEnrichment_0.99.5 BiocGenerics_0.34.0       knitr_1.29               
## 
## loaded via a namespace (and not attached):
##  [1] Biobase_2.48.0        dynamicTreeCut_1.63-1 bit64_4.0.5           RcppParallel_5.0.2   
##  [5] assertthat_0.2.1      expm_0.999-5          stats4_4.0.2          blob_1.2.1           
##  [9] yaml_2.2.1            slam_0.1-47           pillar_1.4.6          RSQLite_2.2.0        
## [13] backports_1.1.9       lattice_0.20-41       glue_1.4.2            digest_0.6.25        
## [17] RColorBrewer_1.1-2    colorspace_1.4-1      cowplot_1.0.0         htmltools_0.5.0      
## [21] Matrix_1.2-18         tm_0.7-7              pkgconfig_2.0.3       GetoptLong_1.0.3     
## [25] magick_2.4.0          purrr_0.3.4           GO.db_3.11.4          scales_1.1.1         
## [29] tibble_3.0.3          farver_2.0.3          generics_0.0.2        dbscan_1.1-5         
## [33] IRanges_2.22.2        ggplot2_3.3.2         ellipsis_0.3.1        NLP_0.2-0            
## [37] MCL_1.0               magrittr_1.5          crayon_1.3.4          memoise_1.1.0        
## [41] evaluate_0.14         apcluster_1.4.8       fs_1.5.0              MASS_7.3-52          
## [45] xml2_1.3.2            tools_4.0.2           org.Hs.eg.db_3.11.4   GlobalOptions_0.1.2  
## [49] lifecycle_0.2.0       matrixStats_0.56.0    ComplexHeatmap_2.5.5  stringr_1.4.0        
## [53] S4Vectors_0.26.1      munsell_0.5.0         cluster_2.1.0         AnnotationDbi_1.50.3 
## [57] compiler_4.0.2        pkgdown_1.5.1         proxyC_0.1.5          rlang_0.4.7          
## [61] rjson_0.2.20          circlize_0.4.11       igraph_1.2.5          labeling_0.3         
## [65] rmarkdown_2.3         gtable_0.3.0          DBI_1.1.0             R6_2.4.1             
## [69] gridExtra_2.3         dplyr_1.0.2           bit_4.0.4             clue_0.3-57          
## [73] rprojroot_1.3-2       shape_1.4.4           desc_1.2.0            GOSemSim_2.14.1      
## [77] stringi_1.4.6         Rcpp_1.0.5            vctrs_0.3.4           png_0.1-7            
## [81] tidyselect_1.1.0      xfun_0.16</code></pre>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Zuguang Gu.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
